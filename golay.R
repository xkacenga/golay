# Initialize B
b1 <-  c(1,1,0,1,1,1,0,0,0,1,0,1)
b2 <-  c(1,0,1,1,1,0,0,0,1,0,1,1)
b3 <-  c(0,1,1,1,0,0,0,1,0,1,1,1)
b4 <-  c(1,1,1,0,0,0,1,0,1,1,0,1)
b5 <-  c(1,1,0,0,0,1,0,1,1,0,1,1)
b6 <-  c(1,0,0,0,1,0,1,1,0,1,1,1)
b7 <-  c(0,0,0,1,0,1,1,0,1,1,1,1)
b8 <-  c(0,0,1,0,1,1,0,1,1,1,0,1)
b9 <-  c(0,1,0,1,1,0,1,1,1,0,0,1)
b10 <- c(1,0,1,1,0,1,1,1,0,0,0,1)
b11 <- c(0,1,1,0,1,1,1,0,0,0,1,1)
b12 <- c(1,1,1,1,1,1,1,1,1,1,1,0)

B <- matrix(c(b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12),
            nrow = 12, ncol = 12, byrow = TRUE)


# Initialize H
h1 <-  c(1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,1,0,0,0,1,0,1)
h2 <-  c(0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,0,0,0,1,0,1,1)
h3 <-  c(0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,1,1,1)
h4 <-  c(0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,1,1,0,1)
h5 <-  c(0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,1,0,1,1,0,1,1)
h6 <-  c(0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,0,1,1,0,1,1,1)
h7 <-  c(0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,1,1,0,1,1,1,1)
h8 <-  c(0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,1,0,1,1,1,0,1)
h9 <-  c(0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,1,0,1,1,1,0,0,1)
h10 <- c(0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,1,0,1,1,1,0,0,0,1)
h11 <- c(0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,1,1,1,0,0,0,1,1)
h12 <- c(0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0)

H <- matrix(c(h1,h2,h3,h4,h5,h6,h7,h8,h9,h10,h11,h12),
            nrow = 12, ncol = 24, byrow = TRUE)

HT <- t(H)

# Initialize e_i
e1 <-  c(1,0,0,0,0,0,0,0,0,0,0,0)
e2 <-  c(0,1,0,0,0,0,0,0,0,0,0,0)
e3 <-  c(0,0,1,0,0,0,0,0,0,0,0,0)
e4 <-  c(0,0,0,1,0,0,0,0,0,0,0,0)
e5 <-  c(0,0,0,0,1,0,0,0,0,0,0,0)
e6 <-  c(0,0,0,0,0,1,0,0,0,0,0,0)
e7 <-  c(0,0,0,0,0,0,1,0,0,0,0,0)
e8 <-  c(0,0,0,0,0,0,0,1,0,0,0,0)
e9 <-  c(0,0,0,0,0,0,0,0,1,0,0,0)
e10 <- c(0,0,0,0,0,0,0,0,0,1,0,0)
e11 <- c(0,0,0,0,0,0,0,0,0,0,1,0)
e12 <- c(0,0,0,0,0,0,0,0,0,0,0,1)

E.i <- matrix(c(e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12),
              nrow = 12, ncol = 12, byrow = TRUE)

# Initialize messages
m1 <- matrix(c(0,0,0,1,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1),
             nrow = 1, ncol = 24, byrow = TRUE)

m2 <- matrix(c(1,1,0,1,0,0,1,1,0,1,0,0,0,1,0,1,1,1,1,0,0,0,0,0),
             nrow = 1, ncol = 24, byrow = TRUE)

w1 <- matrix(c(0,0,1,1,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,0,0,0,0),
             nrow = 1, ncol = 24, byrow = TRUE)

w2 <- matrix(c(1,0,1,0,1,0,1,1,0,0,0,0,1,1,0,1,0,1,1,0,1,0,0,0),
             nrow = 1, ncol = 24, byrow = TRUE)

# Choose message
m <- m1

# Calculate syndrome s1
s <- (m %*% HT) %% 2

# Calculate weight of s1
s.weight <- table(s)

s.weight[2]
if (s.weight[2] <= 3) {
  e <- c(s,c(0,0,0,0,0,0,0,0,0,0,0,0))
  decoded <- (m[1,] + e) %% 2
  print(decoded)
}

for (i in 1:12) {
  s.plus.bi <- (s + B[i,]) %% 2
  s.plus.bi
  s.plus.bi.weight <- table(s.plus.bi)
  if (s.plus.bi.weight[2] <= 2) {
    e <- c(s.plus.bi, E.i[i,])
    decoded <- (m[1,] + e) %% 2
    print(decoded)
  }
}


sB <- (s %*% B) %% 2
sB.weight <- table(sB)

if (sB.weight[2] <= 3) {
  e <- c(0,0,0,0,0,0,0,0,0,0,0,0, sB)
  decoded <- (m[1,] + e) %% 2
  print(decoded)
}

for (i in 1:12) {
  sB.plus.bi <- (sB + B[i,]) %% 2
  sB.plus.bi.weight <- table(sB.plus.bi)
  if (s.plus.bi.weight[2] <= 2) {
    e <- c(E.i[i,], sB.plus.bi)
    decoded <- (m[1,] + e) %% 2
    print(decoded)
  }
}





